import{T as e}from"./b4be29f1.js";import{e as t,i as s,t as r}from"./05905ff1.js";import{p as o,v as l,s as n,M as i,m as f}from"./19d2607c.js";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const u=(e,t,s)=>{const r=new Map;for(let o=t;o<=s;o++)r.set(e[o],o);return r},c=t(class extends s{constructor(e){if(super(e),e.type!==r.CHILD)throw Error("repeat() can only be used in text expressions")}dt(e,t,s){let r;void 0===s?s=t:void 0!==t&&(r=t);const o=[],l=[];let n=0;for(const t of e)o[n]=r?r(t,n):n,l[n]=s(t,n),n++;return{values:l,keys:o}}render(e,t,s){return this.dt(e,t,s).values}update(t,[s,r,c]){const a=o(t),{values:d,keys:h}=this.dt(s,r,c);if(!Array.isArray(a))return this.ut=h,d;const p=this.ut??=[],v=[];let m,y,x=0,b=a.length-1,g=0,j=d.length-1;for(;x<=b&&g<=j;)if(null===a[x])x++;else if(null===a[b])b--;else if(p[x]===h[g])v[g]=l(a[x],d[g]),x++,g++;else if(p[b]===h[j])v[j]=l(a[b],d[j]),b--,j--;else if(p[x]===h[j])v[j]=l(a[x],d[j]),n(t,v[j+1],a[x]),x++,j--;else if(p[b]===h[g])v[g]=l(a[b],d[g]),n(t,a[x],a[b]),b--,g++;else if(void 0===m&&(m=u(h,g,j),y=u(p,x,b)),m.has(p[x]))if(m.has(p[b])){const e=y.get(h[g]),s=void 0!==e?a[e]:null;if(null===s){const e=n(t,a[x]);l(e,d[g]),v[g]=e}else v[g]=l(s,d[g]),n(t,a[x],s),a[e]=null;g++}else i(a[b]),b--;else i(a[x]),x++;for(;g<=j;){const e=n(t,v[j+1]);l(e,d[g]),v[g++]=e}for(;x<=b;){const e=a[x++];null!==e&&i(e)}return this.ut=h,f(t,v),e}});export{c};
